---
phase: 16.2-v2-visual-alignment
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - callvault/src/components/layout/SidebarNav.tsx
  - callvault/src/components/layout/WorkspaceSidebarPane.tsx
  - callvault/src/routes/_authenticated/settings/$category.tsx
  - callvault/src/routes/_authenticated/workspaces/index.tsx
autonomous: true

must_haves:
  truths:
    - "SidebarNav active items show orange text (text-vibe-orange) instead of black text"
    - "SidebarNav collapsed icons render as glossy 3D buttons with gradient, inner shadow, and rounded-xl container"
    - "SidebarNav collapsed active icons have an orange ring and an orange dot indicator below"
    - "Settings sidebar active category shows full 4-layer selection: pill indicator, orange icon, orange text, bg-vibe-orange/10 tint"
    - "WorkspaceSidebarPane active folders show pill indicator, bg-vibe-orange/10 tint, and text-vibe-orange"
    - "Workspaces page OrgSidebar active org shows pill indicator and orange text"
  artifacts:
    - path: "src/components/layout/SidebarNav.tsx"
      provides: "Updated nav with orange active text and glossy collapsed icons"
      contains: "text-vibe-orange"
    - path: "src/components/layout/WorkspaceSidebarPane.tsx"
      provides: "Updated folder items with full selection state"
      contains: "bg-vibe-orange/10"
    - path: "src/routes/_authenticated/settings/$category.tsx"
      provides: "Updated settings sidebar with full 4-layer active state"
      contains: "cv-side-indicator-pill"
    - path: "src/routes/_authenticated/workspaces/index.tsx"
      provides: "Updated OrgSidebar with pill indicator active state"
      contains: "text-vibe-orange"
  key_links:
    - from: "src/components/layout/SidebarNav.tsx"
      to: "src/globals.css"
      via: "cv-side-indicator-pill class"
      pattern: "cv-side-indicator-pill"
    - from: "src/routes/_authenticated/settings/$category.tsx"
      to: "src/globals.css"
      via: "cv-side-indicator-pill class and vibe-orange tokens"
      pattern: "cv-side-indicator-pill|text-vibe-orange"
---

<objective>
Fix all navigation active state styling across V2 to match V1's approved visual language: orange text for active items, glossy 3D icons when collapsed, pill indicators, and full 4-layer selection states.

Purpose: V1's navigation uses a distinctive orange-tinted active state system (pill + orange icon + orange text + tinted background) that makes the current page immediately obvious. V2 uses generic black text and gray backgrounds for active states, which lacks V1's wayfinding clarity.

Output: Updated SidebarNav, Settings sidebar, WorkspaceSidebarPane, and OrgSidebar components with correct V1-matching active states.
</objective>

<execution_context>
@/Users/Naegele/.claude/get-shit-done/workflows/execute-plan.md
@/Users/Naegele/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/16.2-v2-visual-alignment/16.2-RESEARCH.md

Key references (read before implementing):
- /Users/Naegele/dev/brain/docs/design/brand-guidelines-v4.4.md (Navigation & Selection States section, Sidebar Navigation Icons section)
- /Users/Naegele/dev/callvault/src/globals.css (cv-side-indicator-pill utility, vibe-orange tokens)
- /Users/Naegele/dev/callvault/src/components/layout/SidebarNav.tsx (current flat implementation)
- /Users/Naegele/dev/callvault/src/components/layout/WorkspaceSidebarPane.tsx (current folder items)
- /Users/Naegele/dev/callvault/src/routes/_authenticated/settings/$category.tsx (current settings sidebar)
- /Users/Naegele/dev/callvault/src/routes/_authenticated/workspaces/index.tsx (OrgSidebar component)
- /Users/Naegele/dev/callvault/CLAUDE.md (TailwindCSS v4 constraints)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix SidebarNav active text color and collapsed glossy icons</name>
  <files>src/components/layout/SidebarNav.tsx</files>
  <action>
Two changes to SidebarNav.tsx:

**Change 1: Active text color**
In the `Link` className, change the active state from:
```
'bg-vibe-orange/10 font-medium text-foreground'
```
to:
```
'bg-vibe-orange/10 font-semibold text-vibe-orange'
```
Note: `font-medium` becomes `font-semibold` per brand spec.

**Change 2: Collapsed glossy 3D icon buttons**
When `isCollapsed` is true, wrap each nav icon in a glossy 3D container div. The current code just centers the icon with `justify-center px-2 py-2`. Instead:

When `isCollapsed && !isActive`, render the icon inside:
```tsx
<div className={cn(
  'w-11 h-11 rounded-xl flex items-center justify-center',
  'bg-gradient-to-br from-white to-gray-200',
  'border border-gray-300/80',
  'shadow-[inset_0_4px_6px_rgba(255,255,255,0.5),inset_0_-4px_6px_rgba(0,0,0,0.08),0_10px_20px_rgba(0,0,0,0.08)]',
)}>
  <Icon className="w-5 h-5 text-foreground" />
</div>
```

When `isCollapsed && isActive`, add orange ring:
```tsx
<div className={cn(
  'w-11 h-11 rounded-xl flex items-center justify-center',
  'bg-gradient-to-br from-white to-gray-200',
  'border border-gray-300/80',
  'shadow-[inset_0_4px_6px_rgba(255,255,255,0.5),inset_0_-4px_6px_rgba(0,0,0,0.08),0_10px_20px_rgba(0,0,0,0.08)]',
  'ring-2 ring-vibe-orange/50',
)}>
  <Icon className="w-5 h-5 text-vibe-orange" />
</div>
```

Plus an orange dot below the active collapsed icon:
```tsx
{isCollapsed && isActive && (
  <div className="w-1.5 h-1.5 rounded-full bg-vibe-orange mx-auto mt-1" />
)}
```

The collapsed Link wrapper should change from horizontal layout to vertical (flex-col items-center) when collapsed so the dot appears below the icon. Remove the pill indicator when collapsed (the dot replaces it).

Keep the existing pill indicator for the expanded state — it's already correct.

Restructure the Link contents:
- Expanded: pill indicator + Icon (16px, inline) + label text (as today, but with text-vibe-orange active)
- Collapsed: glossy icon container (no pill) + orange dot below if active

Also apply the same glossy treatment to the bottom section buttons ("How it works", "Toggle panels") when collapsed.
  </action>
  <verify>
1. TypeScript compiles: `cd /Users/Naegele/dev/callvault && npx tsc --noEmit --pretty 2>&1 | head -20`
2. Grep confirms active text is orange: `grep -n 'text-vibe-orange' src/components/layout/SidebarNav.tsx`
3. Grep confirms glossy gradient: `grep -n 'from-white to-gray-200' src/components/layout/SidebarNav.tsx`
  </verify>
  <done>SidebarNav active items show text-vibe-orange text, collapsed icons render as glossy 3D buttons with gradient/shadow, active collapsed icons have orange ring and dot indicator below</done>
</task>

<task type="auto">
  <name>Task 2: Fix Settings sidebar, WorkspaceSidebarPane, and OrgSidebar active states</name>
  <files>
    src/routes/_authenticated/settings/$category.tsx
    src/components/layout/WorkspaceSidebarPane.tsx
    src/routes/_authenticated/workspaces/index.tsx
  </files>
  <action>
Three components need the same active state pattern: full 4-layer selection (pill indicator, orange icon, orange text, tinted background).

**Settings sidebar ($category.tsx) — SettingsSidebar component:**
Change the active category Link from:
```
'bg-muted text-foreground font-medium'
```
to:
```
'bg-vibe-orange/10 font-semibold text-vibe-orange'
```

Add pill indicator inside the Link (same pattern as SidebarNav):
```tsx
{isActive && (
  <span className="cv-side-indicator-pill" aria-hidden="true" />
)}
```

Change Icon active color from `text-foreground` to `text-vibe-orange`.

**WorkspaceSidebarPane.tsx — FolderItem component:**
Change active folder button from:
```
'bg-muted text-foreground font-medium'
```
to:
```
'bg-vibe-orange/10 font-medium text-vibe-orange'
```

Add a relative position to the button wrapper and add a pill indicator:
```tsx
{isActive && (
  <span className="cv-side-indicator-pill" aria-hidden="true" />
)}
```

The button needs `relative` class added for the absolute-positioned pill.

Also change the active folder icon color from `text-brand-400` to `text-vibe-orange` (they're the same hue but use the correct token name for consistency with the active state pattern).

**WorkspaceSidebarPane.tsx — WorkspaceItem component:**
Change active workspace header from:
```
'bg-muted text-foreground font-medium'
```
to:
```
'bg-vibe-orange/10 font-medium text-vibe-orange'
```

Add `relative` class and pill indicator to the workspace button as well.

**OrgSidebar (workspaces/index.tsx):**
Change the active org button from:
```
'bg-muted text-foreground font-medium'
```
to:
```
'relative bg-vibe-orange/10 font-medium text-vibe-orange'
```

Add pill indicator:
```tsx
{activeOrgId === org.id && (
  <span className="cv-side-indicator-pill" aria-hidden="true" />
)}
```

All four components use the same visual pattern — the `cv-side-indicator-pill` CSS class already exists in globals.css with the correct styling (absolute positioned, left edge, 65% height, vibe orange, rounded).
  </action>
  <verify>
1. TypeScript compiles: `cd /Users/Naegele/dev/callvault && npx tsc --noEmit --pretty 2>&1 | head -20`
2. Settings sidebar uses orange active: `grep -n 'text-vibe-orange' src/routes/_authenticated/settings/\\$category.tsx`
3. WorkspaceSidebarPane uses pill: `grep -n 'cv-side-indicator-pill' src/components/layout/WorkspaceSidebarPane.tsx`
4. OrgSidebar uses pill: `grep -n 'cv-side-indicator-pill' src/routes/_authenticated/workspaces/index.tsx`
  </verify>
  <done>Settings sidebar, WorkspaceSidebarPane folder items, workspace headers, and OrgSidebar all show full 4-layer active state (pill indicator, orange icon, orange text, bg-vibe-orange/10 tint)</done>
</task>

</tasks>

<verification>
- `cd /Users/Naegele/dev/callvault && npx tsc --noEmit` passes with zero errors
- All navigation components use `text-vibe-orange` for active text instead of `text-foreground`
- All sidebar lists use `cv-side-indicator-pill` for active indicator
- SidebarNav collapsed icons render with glossy gradient
- No functional behavior changes (routing, state, etc.)
</verification>

<success_criteria>
- SidebarNav active items show orange text (font-semibold text-vibe-orange)
- SidebarNav collapsed icons use glossy 3D gradient treatment
- Settings sidebar uses full 4-layer selection state
- WorkspaceSidebarPane folders and workspaces use pill + orange active state
- OrgSidebar on workspaces page uses pill + orange active state
- All TypeScript compiles cleanly
</success_criteria>

<output>
After completion, create `.planning/phases/16.2-v2-visual-alignment/16.2-02-SUMMARY.md`
</output>
