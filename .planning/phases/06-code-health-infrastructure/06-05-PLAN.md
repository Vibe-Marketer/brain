---
phase: 06-code-health-infrastructure
plan: 05
type: execute
wave: 1
depends_on: []
files_modified:
  - supabase/functions/coach-notes/index.ts
  - supabase/functions/coach-relationships/index.ts
  - supabase/functions/coach-shares/index.ts
  - supabase/functions/send-coach-invite/index.ts
  - src/pages/TeamManagement.tsx
  - src/hooks/useCoachRelationships.ts
  - docs/adr/0006-dead-code-removal-phase6.md
  - CHANGELOG.md
autonomous: true

must_haves:
  truths:
    - "Dead coach Edge Functions deleted or stubbed with deprecation notice"
    - "Orphaned TeamManagement.tsx deleted if not routed"
    - "ADR documents what was removed and why"
    - "CHANGELOG updated with removals"
  artifacts:
    - path: "docs/adr/0006-dead-code-removal-phase6.md"
      provides: "Architecture Decision Record for removals"
      min_lines: 30
  key_links:
    - from: "CHANGELOG.md"
      to: "docs/adr/0006-dead-code-removal-phase6.md"
      via: "reference"
      pattern: "ADR-0006\|dead.*code"
---

<objective>
Delete dead code: Coach Edge Functions, orphaned TeamManagement.tsx

Purpose: Clean up unused code per CLEAN-02 requirement
Output: Dead code removed, ADR documenting decisions, CHANGELOG updated
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-code-health-infrastructure/06-CONTEXT.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Audit and document code for removal</name>
  <files>
    docs/adr/0006-dead-code-removal-phase6.md
  </files>
  <action>
1. Trace all references to coach functions:
   - `grep -r "coach-notes" src/ supabase/functions/`
   - `grep -r "coach-relationships" src/ supabase/functions/`
   - `grep -r "coach-shares" src/ supabase/functions/`
   - `grep -r "send-coach-invite" src/ supabase/functions/`

2. Trace TeamManagement.tsx references:
   - `grep -r "TeamManagement" src/`
   - Check if routed in App.tsx or routes.tsx
   - Check if imported anywhere

3. Trace useCoachRelationships hook usage:
   - Found in: CoachesTab.tsx, CoacheeInviteDialog.tsx, CoachInviteDialog.tsx, CoachDashboard.tsx, SharedWithMe.tsx
   - These are ACTIVE components - hook is NOT dead code

4. Decision matrix:
   - coach-notes, coach-relationships, coach-shares: DELETE (no frontend callers found)
   - send-coach-invite: KEEP (called by useCoachRelationships which is used by active components)
   - TeamManagement.tsx: DELETE (not routed, no imports)
   - useCoachRelationships.ts: KEEP (actively used)

5. Create ADR documenting:
   - What was removed
   - Why (no references, not routed)
   - What was kept and why
   - Future considerations
  </action>
  <verify>
    - ADR file exists at docs/adr/0006-dead-code-removal-phase6.md
    - ADR contains decision rationale for each item
  </verify>
  <done>
    ADR created documenting removal decisions with traced references
  </done>
</task>

<task type="auto">
  <name>Task 2: Delete dead code and update CHANGELOG</name>
  <files>
    supabase/functions/coach-notes/index.ts
    supabase/functions/coach-relationships/index.ts
    supabase/functions/coach-shares/index.ts
    src/pages/TeamManagement.tsx
    CHANGELOG.md
  </files>
  <action>
1. Delete confirmed dead code:
   - `rm -rf supabase/functions/coach-notes/`
   - `rm -rf supabase/functions/coach-relationships/`
   - `rm -rf supabase/functions/coach-shares/`
   - `rm src/pages/TeamManagement.tsx`

2. Keep send-coach-invite (actively used by useCoachRelationships)

3. Update CHANGELOG.md:
   - Add entry under "Removed" section
   - Reference ADR-0006
   - List what was removed

4. Verify no broken imports:
   - `npm run typecheck`
   - `npm run build`

5. Note for Supabase dashboard cleanup:
   - These functions need to be deleted from Supabase dashboard separately
   - Document in ADR that dashboard cleanup is needed
  </action>
  <verify>
    - `ls supabase/functions/coach-notes 2>/dev/null` returns error (doesn't exist)
    - `ls supabase/functions/coach-relationships 2>/dev/null` returns error
    - `ls supabase/functions/coach-shares 2>/dev/null` returns error
    - `ls src/pages/TeamManagement.tsx 2>/dev/null` returns error
    - `npm run build` passes
    - CHANGELOG.md contains removal entry
  </verify>
  <done>
    Dead code deleted, CHANGELOG updated, build still passes
  </done>
</task>

</tasks>

<verification>
1. 3 Edge Function directories deleted (coach-notes, coach-relationships, coach-shares)
2. TeamManagement.tsx deleted
3. send-coach-invite preserved (actively used)
4. useCoachRelationships.ts preserved (actively used)
5. ADR documents all decisions
6. CHANGELOG updated
7. Build passes
</verification>

<success_criteria>
- Dead coach Edge Functions removed (3 of 4)
- Orphaned TeamManagement.tsx removed
- Active coach code preserved (send-coach-invite, useCoachRelationships)
- ADR-0006 documents decisions
- CHANGELOG has removal entry
- No broken imports or build failures
</success_criteria>

<output>
After completion, create `.planning/phases/06-code-health-infrastructure/06-05-SUMMARY.md`
</output>
