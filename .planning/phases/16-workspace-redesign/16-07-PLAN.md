---
phase: 16-workspace-redesign
plan: 07
type: execute
wave: 5
depends_on: ["16-03", "16-04", "16-05", "16-06"]
files_modified:
  - /Users/Naegele/dev/callvault/src/routes/_authenticated/index.tsx
  - /Users/Naegele/dev/callvault/src/routes/_authenticated/workspaces/index.tsx
  - /Users/Naegele/dev/callvault/src/routes/_authenticated/workspaces/$workspaceId.tsx
  - /Users/Naegele/dev/callvault/src/routes/_authenticated/calls/$callId.tsx
  - /Users/Naegele/dev/callvault/src/routes/_authenticated/folders/$folderId.tsx
  - /Users/Naegele/dev/callvault/src/routes/_authenticated/settings/$category.tsx
  - /Users/Naegele/dev/callvault/src/routes/_authenticated/import/index.tsx
  - /Users/Naegele/dev/callvault/src/routes/_authenticated/sharing/index.tsx
  - /Users/Naegele/dev/callvault/src/components/layout/SidebarNav.tsx
autonomous: false

must_haves:
  truths:
    - "Zero instances of Bank, Vault, or Hub visible anywhere in the UI"
    - "All route pages use Organization/Workspace/Folder terminology consistently"
    - "Workspace settings page includes WorkspaceMemberPanel"
    - "DnD call-to-folder works on desktop calls list"
    - "Action menu on call rows includes Move to Folder option"
    - "Folder route page shows folder contents with breadcrumbs"
    - "Workspace detail page shows workspace info with member management access"
  artifacts:
    - path: "/Users/Naegele/dev/callvault/src/routes/_authenticated/index.tsx"
      provides: "Home page with DnD-enabled calls list, workspace sidebar, breadcrumbs, action menus"
      contains: "DndCallProvider"
    - path: "/Users/Naegele/dev/callvault/src/routes/_authenticated/workspaces/$workspaceId.tsx"
      provides: "Workspace detail with member panel access"
      contains: "WorkspaceMemberPanel"
    - path: "/Users/Naegele/dev/callvault/src/routes/_authenticated/settings/$category.tsx"
      provides: "Settings with organizations category for org management"
      contains: "Organization"
  key_links:
    - from: "/Users/Naegele/dev/callvault/src/routes/_authenticated/index.tsx"
      to: "/Users/Naegele/dev/callvault/src/components/dnd/DndCallProvider.tsx"
      via: "DndCallProvider wraps calls list for drag-to-folder"
      pattern: "DndCallProvider"
    - from: "/Users/Naegele/dev/callvault/src/routes/_authenticated/workspaces/$workspaceId.tsx"
      to: "/Users/Naegele/dev/callvault/src/components/workspace/WorkspaceMemberPanel.tsx"
      via: "Workspace detail includes member management"
      pattern: "WorkspaceMemberPanel"
---

<objective>
Complete the full integration: wire all route pages with new components, terminology sweep, DnD integration, action menus, and human verification of the complete workspace redesign.

Purpose: This is the final assembly plan. All building blocks exist (navigation, folders, invites, onboarding). This plan wires them into every route page, performs the WKSP-01/02/03 terminology sweep, integrates DnD into the calls list, adds action menus for folder assignment, and includes a human verification checkpoint.

Output: All authenticated route pages updated with new terminology and components. Complete Phase 16 UX.
</objective>

<execution_context>
@/Users/Naegele/.claude/get-shit-done/workflows/execute-plan.md
@/Users/Naegele/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@/Users/Naegele/dev/brain/.planning/phases/16-workspace-redesign/16-CONTEXT.md
@/Users/Naegele/dev/brain/.planning/phases/16-workspace-redesign/16-RESEARCH.md
@/Users/Naegele/dev/brain/.planning/phases/16-workspace-redesign/16-03-SUMMARY.md
@/Users/Naegele/dev/brain/.planning/phases/16-workspace-redesign/16-04-SUMMARY.md
@/Users/Naegele/dev/brain/.planning/phases/16-workspace-redesign/16-05-SUMMARY.md
@/Users/Naegele/dev/brain/.planning/phases/16-workspace-redesign/16-06-SUMMARY.md
@/Users/Naegele/dev/callvault/src/routes/_authenticated/index.tsx
@/Users/Naegele/dev/callvault/src/routes/_authenticated/workspaces/$workspaceId.tsx
@/Users/Naegele/dev/callvault/src/routes/_authenticated/settings/$category.tsx
@/Users/Naegele/dev/callvault/src/components/layout/SidebarNav.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: DnD integration, action menus, and calls list enhancement</name>
  <files>
    /Users/Naegele/dev/callvault/src/routes/_authenticated/index.tsx
    /Users/Naegele/dev/callvault/src/routes/_authenticated/calls/$callId.tsx
    /Users/Naegele/dev/callvault/src/routes/_authenticated/folders/$folderId.tsx
  </files>
  <action>
    **index.tsx (home / calls list)** — Complete integration of all Phase 16 components.

    1. Wrap calls list in `<DndCallProvider>` from Plan 04 — enables drag-to-folder on desktop
    2. Each call row becomes `<DraggableCallRow>` wrapping the existing Link
    3. Add action menu (3-dot "..." button) on each call row with:
       - "Move to Folder" — opens a folder picker dropdown (list active folders from useFolders)
       - "Open" — navigates to /calls/:id
       - "Share" — placeholder (future Phase 21)
    4. WorkspaceSidebarPane folders wrapped in `<FolderDropZone>` from Plan 04
    5. WorkspaceBreadcrumb at top of main content (from Plan 03)
    6. Recordings query scoped: when activeWorkspaceId is set, filter recordings by workspace. When activeFolderId is set, filter by folder_assignments.
    7. When no workspace selected (fresh org switch), show "Select a workspace" message in main area

    **calls/$callId.tsx (call detail)** — Update:
    1. Add breadcrumb at top: Org > Workspace > Folder (if applicable) > Call Title
    2. Add "Move to Folder" in action area (same folder picker as list action menu)
    3. Ensure all text uses "Call" not "Recording" in user-facing labels (recording is internal DB term)

    **folders/$folderId.tsx** — Wire:
    1. Fetch folder by ID from useFolders or direct query
    2. Show breadcrumb: Org > Workspace > Folder Name
    3. List recordings in this folder (via folder_assignments join)
    4. Actions: Rename folder (inline edit), Archive folder button
    5. Same DnD + action menu pattern as home page for calls within the folder
  </action>
  <verify>
    1. `cd /Users/Naegele/dev/callvault && pnpm build` succeeds
    2. `grep "DndCallProvider" src/routes/_authenticated/index.tsx` confirms DnD wrapper
    3. `grep "Move to Folder" src/routes/_authenticated/index.tsx` confirms action menu
    4. `grep "WorkspaceBreadcrumb" src/routes/_authenticated/calls/\\$callId.tsx` confirms breadcrumb on detail
  </verify>
  <done>
    Calls list has DnD enabled with draggable rows and folder drop zones. Action menus provide "Move to Folder" on all devices. Call detail has breadcrumbs and folder assignment. Folder route shows contents with rename and archive actions.
  </done>
</task>

<task type="auto">
  <name>Task 2: Terminology sweep and remaining route updates</name>
  <files>
    /Users/Naegele/dev/callvault/src/routes/_authenticated/workspaces/index.tsx
    /Users/Naegele/dev/callvault/src/routes/_authenticated/workspaces/$workspaceId.tsx
    /Users/Naegele/dev/callvault/src/routes/_authenticated/settings/$category.tsx
    /Users/Naegele/dev/callvault/src/routes/_authenticated/import/index.tsx
    /Users/Naegele/dev/callvault/src/routes/_authenticated/sharing/index.tsx
    /Users/Naegele/dev/callvault/src/components/layout/SidebarNav.tsx
  </files>
  <action>
    **WKSP-01/02/03 Terminology Sweep** — Zero instances of "Bank," "Vault," or "Hub" visible anywhere in the UI. This is a phase success criterion.

    Systematically update ALL user-facing text in the v2 codebase:
    - "Bank" -> "Organization" (all contexts)
    - "Vault" -> "Workspace" (all contexts)
    - "Hub" -> "Folder" (all contexts)

    Run `grep -rn "Bank\|Vault\|Hub" src/` to find every instance. Exclude:
    - Import paths referencing v1 code (if any)
    - supabase.ts generated types (auto-generated, not user-facing)
    - Internal variable names that reference DB tables (e.g., `bank_id` in service code is fine — it's internal)
    - Comments explaining the mapping (e.g., "Organization = Bank in DB" is fine)

    ONLY change user-facing strings: headings, labels, toasts, error messages, placeholder text, tooltips, aria-labels.

    **Route-specific updates:**

    **workspaces/index.tsx** — Workspace list page:
    - Heading: "Workspaces" (not "Vaults")
    - Show list of workspaces in active org
    - Each workspace card shows: name, member count, call count, "Default" badge if is_default
    - "Create Workspace" button

    **workspaces/$workspaceId.tsx** — Workspace detail page:
    - Show workspace name, org context in breadcrumb
    - Include WorkspaceMemberPanel from Plan 05 in a settings section or tab
    - "Invite" button opens WorkspaceInviteDialog
    - Folder list within the workspace

    **settings/$category.tsx** — Settings page:
    - Add "Organizations" category to settings nav (alongside Account, etc.)
    - Organizations settings shows list of user's orgs with ability to rename, manage members
    - If current category is "organizations", show org management UI
    - Remove any "Banks" references in settings categories

    **import/index.tsx** — Import hub:
    - Ensure all copy says "Workspace" not "Vault" (e.g., "Import calls to your workspace")
    - Import destination should reference active workspace

    **sharing/index.tsx** — Sharing page:
    - "Shared With Me" — ensure terminology uses "Workspace" not "Vault"

    **SidebarNav.tsx** — Final cleanup:
    - Nav item "Workspaces" should link to /workspaces (add if not present)
    - Ensure no "Vault" or "Hub" text remains
    - "How it works" link from Plan 06 should be present

    Final verification: Run `grep -rni "bank\|vault\|hub" src/ --include="*.tsx" --include="*.ts" | grep -v "node_modules" | grep -v "supabase.ts" | grep -v ".service.ts" | grep -v "store" | grep -v "// "` and verify zero user-facing hits.
  </action>
  <verify>
    1. `cd /Users/Naegele/dev/callvault && pnpm build` succeeds
    2. Run terminology audit: `grep -rni '"Bank\|"Vault\|"Hub\|Bank"\|Vault"\|Hub"' src/ --include="*.tsx" | grep -v supabase.ts | grep -v node_modules` returns zero lines (no user-facing old terminology)
    3. `grep "Organization" src/routes/_authenticated/settings/\\$category.tsx` confirms organizations settings
    4. `grep "WorkspaceMemberPanel" src/routes/_authenticated/workspaces/\\$workspaceId.tsx` confirms member management
  </verify>
  <done>
    Zero instances of Bank/Vault/Hub in user-facing UI text (WKSP-01/02/03). Workspace list and detail pages use new terminology. Settings includes Organizations category. Import and sharing pages updated. SidebarNav cleaned and has Workspaces link. Full terminology audit passes.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 3: Human verification of complete workspace redesign</name>
  <action>
    Pause for human verification of the complete Phase 16 Workspace Redesign at the production URL.

    The user should verify:
    1. Navigate to https://callvault.vercel.app — verify OrgSwitcherBar shows at top with org name and house icon (personal org)
    2. Click the org dropdown — verify organizations list and "Create Organization" option
    3. Check sidebar — verify workspaces listed as expandable items with folders underneath
    4. Click a workspace — verify it expands showing folders, breadcrumb updates
    5. Check breadcrumbs at top of main content — verify "Org > Workspace" trail is clickable
    6. Try creating a folder inside a workspace — verify it appears in the sidebar
    7. Try dragging a call onto a folder in the sidebar (desktop) — verify it assigns
    8. Try the action menu ("...") on a call — verify "Move to Folder" option works
    9. Open Workspace settings — verify "Members" and "Pending Invites" tabs exist
    10. Try "Invite" — verify the dialog shows both Org and Workspace name, has role picker
    11. Do a text search (Ctrl+F) for "Bank", "Vault", "Hub" on every visible page — verify zero hits
    12. Check if you see the onboarding explorer (if first time) OR click "How it works" in sidebar
    13. Verify old URL works: navigate to /vaults — verify it redirects to /workspaces
  </action>
  <verify>User confirms all 13 verification steps pass at the production URL.</verify>
  <done>User types "approved" if the workspace redesign looks correct, or describes any issues to fix.</done>
</task>

</tasks>

<verification>
- All route pages use Organization/Workspace/Folder terminology (WKSP-01/02/03)
- DnD call-to-folder works on desktop
- Action menus available on all devices for folder assignment
- Workspace detail includes member management
- Settings has Organizations category
- Zero "Bank/Vault/Hub" in user-facing text
- All prior plan components (navigation, folders, invites, onboarding) are integrated
- Human verification of complete UX
</verification>

<success_criteria>
1. Zero instances of "Bank," "Vault," or "Hub" visible anywhere in the UI (WKSP-01/02/03)
2. All route pages consistently use Organization/Workspace/Folder
3. DnD and action menu both work for call-to-folder assignment
4. Workspace settings integrates member management panel
5. Settings includes Organizations management
6. Old URLs redirect properly
7. Human-verified at production URL
</success_criteria>

<output>
After completion, create `.planning/phases/16-workspace-redesign/16-07-SUMMARY.md`
</output>
