---
phase: 16.1-workspace-polish-brand-guidelines
plan: "02"
subsystem: frontend-ui
tags: [sidebar-nav, active-state, dialog, workspace, brand-guidelines]
dependency_graph:
  requires: ["16.1-01"]
  provides: ["polished-sidebar-nav", "create-workspace-dialog"]
  affects: ["SidebarNav", "WorkspaceSidebarPane", "workspaces-page"]
tech_stack:
  added: []
  patterns: ["4-layer-active-state", "radix-dialog", "fill-icon-variant"]
key_files:
  created:
    - /Users/Naegele/dev/callvault/src/components/layout/CreateWorkspaceDialog.tsx
  modified:
    - /Users/Naegele/dev/callvault/src/components/layout/SidebarNav.tsx
    - /Users/Naegele/dev/callvault/src/components/layout/WorkspaceSidebarPane.tsx
    - /Users/Naegele/dev/callvault/src/routes/_authenticated/workspaces/index.tsx
decisions:
  - "Used bg-foreground/text-background for CTA buttons instead of raw bg-brand-400 — adapts to light/dark mode and follows brand guidelines"
  - "Dialog renders conditionally (activeOrgId guard) to avoid passing empty string orgId to mutation"
metrics:
  duration: "~2 minutes"
  completed: "2026-02-28"
  tasks_completed: 2
  files_changed: 4
---

# Phase 16.1 Plan 02: SidebarNav Polish + CreateWorkspaceDialog Summary

**One-liner:** 4-layer Linear-quality active state on SidebarNav (pill + fill icon + vibe-orange tint) and Radix Dialog replacing both window.prompt() workspace creation calls.

## What Was Built

### Task 1: SidebarNav 4-Layer Active State (commit: e84243f)

Upgraded SidebarNav from `bg-muted` active state to full brand-compliant 4-layer treatment:

1. **Background tint** — `bg-vibe-orange/10` replaces `bg-muted` for active items
2. **Fill icon variant** — `RiPhoneFill`, `RiGroup2Fill`, `RiDownloadFill`, `RiSettings3Fill` used when active; line variants when inactive
3. **Icon color** — `text-vibe-orange` for active, `text-muted-foreground` for inactive
4. **Left-edge pill indicator** — `absolute left-0 top-1/2 -translate-y-1/2 w-1 h-[65%] rounded-r-full bg-vibe-orange`

Added `iconActive` field to `NavItem` interface. Link has `relative` positioning for pill anchor. Collapsed state (icon-only) preserves all 4 layers.

### Task 2: CreateWorkspaceDialog + window.prompt() Elimination (commit: 6d0cc45)

**CreateWorkspaceDialog.tsx** (new file) — Exact pattern match of CreateOrganizationDialog:
- Props: `open`, `onOpenChange`, `orgId`
- Radix Dialog.Root/Portal/Overlay/Content/Title/Description/Close
- `autoFocus` input, submit on Enter, disable when empty or pending
- Error toast via `sonner` on mutation failure
- Clears state on dialog close

**WorkspaceSidebarPane.tsx** — Removed `window.prompt()`, added `dialogOpen` state, "+" button opens dialog, dialog rendered at component bottom.

**workspaces/index.tsx** — Removed `window.prompt()`, removed `useCreateWorkspace` direct usage (delegated to dialog), both "Create Workspace" buttons open dialog. Raw `bg-brand-400` replaced with `bg-foreground text-background` (dark button in light mode, light in dark mode — the Linear-style CTA approach).

## Decisions Made

1. **Button styling for CTA:** Used `bg-foreground text-background` instead of raw `bg-brand-400`. This adapts correctly to light/dark mode and avoids using vibe orange as a button background (brand guidelines: vibe orange is an accent, not a button color). The brand-500/brand-600 pattern from CreateOrganizationDialog's submit button is reserved for form submission only.

2. **Dialog org guard:** Dialog only renders when `activeOrgId` is non-null — prevents passing an empty string to the mutation which would cause a backend error.

## Deviations from Plan

None — plan executed exactly as written. All 4 layers of the active state were implemented as specified. The dialog pattern follows CreateOrganizationDialog exactly. Both button locations updated.

## Verification Results

- TypeScript: PASS (zero errors)
- `window.prompt` search: 0 actual calls (only reference is in a JSDoc comment)
- `bg-brand-400` in workspaces/index.tsx: 0 occurrences
- `Dialog.Root` in CreateWorkspaceDialog.tsx: present
- `CreateWorkspaceDialog` imported in WorkspaceSidebarPane.tsx: present
- `CreateWorkspaceDialog` imported in workspaces/index.tsx: present

## Self-Check: PASSED

All 4 files verified present on disk. Both commits (e84243f, 6d0cc45) confirmed in git log.
