---
phase: 16.1-workspace-polish-brand-guidelines
plan: 03
type: execute
wave: 3
depends_on: ["16.1-01", "16.1-02"]
files_modified:
  - /Users/Naegele/dev/callvault/src/routes/_authenticated/import/index.tsx
  - /Users/Naegele/dev/callvault/src/routes/_authenticated/index.tsx
  - /Users/Naegele/dev/callvault/src/routes/_authenticated/settings/index.tsx
  - /Users/Naegele/dev/callvault/src/components/layout/WorkspaceBreadcrumb.tsx
  - /Users/Naegele/dev/callvault/src/components/layout/WorkspaceSidebarPane.tsx
  - /Users/Naegele/dev/callvault/src/globals.css
autonomous: true

must_haves:
  truths:
    - "Import tab active indicator uses vibe-orange, not black"
    - "CallActionMenu uses Radix DropdownMenu, not hand-rolled div + useState"
    - "All surfaces pass visual audit: consistent spacing, alignment, typography"
    - "Settings pages show proper placeholder content, not raw 'Coming soon' text"
    - "Breadcrumb spacing and visual weight feels right"
    - "Dark mode does not have broken layouts or invisible text"
  artifacts:
    - path: "src/routes/_authenticated/import/index.tsx"
      provides: "Vibe-orange tab indicator, consistent styling"
      contains: "border-vibe-orange"
    - path: "src/routes/_authenticated/index.tsx"
      provides: "Radix DropdownMenu for CallActionMenu"
      contains: "DropdownMenu.Root"
  key_links:
    - from: "import/index.tsx tab buttons"
      to: "brand guidelines v4.2 tab navigation section"
      via: "vibe-orange underline for active tabs"
      pattern: "border-vibe-orange"
    - from: "index.tsx CallActionMenu"
      to: "radix-ui DropdownMenu"
      via: "proper dropdown primitive"
      pattern: "DropdownMenu"
---

<objective>
Systematic visual audit and fix pass across all remaining Phase 16 surfaces: import page tabs, CallActionMenu, calls list, settings, breadcrumbs, workspace sidebar fine-tuning, and dark mode verification. Fix everything that catches the eye negatively.

Purpose: After Plans 01 and 02 fixed the structural issues (AppShell, nav states, dialogs), this plan sweeps through every remaining surface to tighten spacing, fix brand compliance, replace hand-rolled components, and ensure dark mode works. The quality bar is "I'd show it to a customer" per user decision.

Output: Every Phase 16 surface passes visual inspection. Import tabs use vibe-orange. CallActionMenu uses Radix. Settings pages have proper empty states. Breadcrumbs feel right. Dark mode works.
</objective>

<execution_context>
@/Users/Naegele/.claude/get-shit-done/workflows/execute-plan.md
@/Users/Naegele/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@/Users/Naegele/dev/brain/.planning/ROADMAP.md
@/Users/Naegele/dev/brain/.planning/phases/16.1-workspace-polish-brand-guidelines/16.1-RESEARCH.md
@/Users/Naegele/dev/brain/docs/design/brand-guidelines-v4.2.md
@/Users/Naegele/dev/brain/src/CLAUDE.md
@/Users/Naegele/dev/callvault/src/routes/_authenticated/import/index.tsx
@/Users/Naegele/dev/callvault/src/routes/_authenticated/index.tsx
@/Users/Naegele/dev/callvault/src/globals.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix Import tabs + CallActionMenu + calls list polish</name>
  <files>
    /Users/Naegele/dev/callvault/src/routes/_authenticated/import/index.tsx
    /Users/Naegele/dev/callvault/src/routes/_authenticated/index.tsx
  </files>
  <action>
**Import page tab indicator (import/index.tsx):**

The active tab currently uses `border-b-2 border-foreground` which renders as a black/dark underline. Per brand guidelines v4.2 "9 Approved Uses of Vibe Orange" item #1: active tab underlines use vibe orange.

Change the active tab styling from:
```
'text-foreground border-b-2 border-foreground -mb-px'
```
To:
```
'text-foreground border-b-2 border-vibe-orange -mb-px'
```

Apply this to both the "Sources" and "Rules" tab buttons in the tab bar. Keep inactive tab styling as-is (`text-muted-foreground hover:text-foreground`).

**CallActionMenu (index.tsx) — replace hand-rolled dropdown with Radix DropdownMenu:**

The current CallActionMenu (lines ~64-197) uses a custom div with useState, useRef, useEffect for outside-click handling, and manual positioning. Replace with Radix DropdownMenu which handles all of this automatically plus provides keyboard navigation and accessibility.

Rewrite CallActionMenu to use:
- `DropdownMenu.Root` with `open` and `onOpenChange` state
- `DropdownMenu.Trigger` wrapping the existing "..." button (RiMoreLine)
- `DropdownMenu.Portal` > `DropdownMenu.Content` for the dropdown
- `DropdownMenu.Item` for each option (Move to Folder, Open)
- `DropdownMenu.Sub` > `DropdownMenu.SubTrigger` > `DropdownMenu.SubContent` for the folder picker submenu

Import `{ DropdownMenu }` from `'radix-ui'` (already installed, used in OrgSwitcherBar).

Style the dropdown content to match the OrgSwitcherBar dropdown styling:
- `rounded-lg border border-border bg-card shadow-md`
- Animate in/out with the standard Radix data-state animations
- Items: `rounded-md mx-1 px-2 py-1.5 text-xs cursor-pointer select-none outline-none focus:bg-muted/70 hover:bg-muted/70`

The folder picker sub-menu should use DropdownMenu.Sub with SubContent appearing to the side (Radix handles positioning). This replaces the manual `showFolderPicker` state toggle.

Remove the `useRef`, the `useEffect` for outside-click detection, and the `showFolderPicker` state — Radix handles all of this.

Keep the existing `handleMoveToFolder` logic and the `assignToFolder` mutation.

**Calls list general polish (index.tsx):**
- Verify call row spacing feels right (currently `gap-1` between rows with `px-4 py-3` padding). Compare against Linear's list density. If rows feel too spaced or too tight, adjust.
- Verify the source badge (`bg-muted px-2 py-0.5 text-[11px]`) doesn't look like a button — it should be clearly a tag/badge.
- Verify the hover state (`hover:bg-muted/50`) is subtle enough — not jarring.
- Verify the DnD handle doesn't interfere with row click (this is already handled via DraggableCallRow but verify visually).
  </action>
  <verify>
1. Navigate to /import in dev-browser
2. Click between Sources and Rules tabs — verify vibe orange underline on active tab
3. Navigate to / (calls list)
4. Hover over a call row — verify the "..." menu appears
5. Click "..." — verify Radix DropdownMenu opens with keyboard-navigable items
6. Click "Move to Folder" — verify sub-menu opens with folder list
7. Press Escape — verify menu closes
8. Verify no console errors related to Radix or old menu code
9. Run `cd /Users/Naegele/dev/callvault && npx tsc --noEmit`
  </verify>
  <done>
Import tab active indicator uses vibe-orange underline per brand guidelines. CallActionMenu uses Radix DropdownMenu with proper keyboard navigation, submenu for folder picker, and automatic outside-click handling. Calls list rows have appropriate density and hover states.
  </done>
</task>

<task type="auto">
  <name>Task 2: Audit + fix remaining surfaces: settings, breadcrumbs, sidebar, dark mode</name>
  <files>
    /Users/Naegele/dev/callvault/src/routes/_authenticated/settings/index.tsx
    /Users/Naegele/dev/callvault/src/components/layout/WorkspaceBreadcrumb.tsx
    /Users/Naegele/dev/callvault/src/components/layout/WorkspaceSidebarPane.tsx
    /Users/Naegele/dev/callvault/src/globals.css
  </files>
  <action>
This is the comprehensive audit sweep. Use dev-browser to visit every page and fix what catches the eye. Specific known areas:

**Settings page (settings/index.tsx):**
- Read the current settings page code
- If settings categories show "Coming soon" placeholder text, upgrade to proper empty states:
  - Use a centered icon (RiSettings3Line or category-specific icon) at 32px size, muted color
  - Descriptive heading: "Account settings coming soon" (or similar per category)
  - Subtitle: "This section is under development."
  - Use the empty state pattern: `flex items-center justify-center h-full` with centered content
- If settings has a sidebar nav within Pane 3, verify its active states match the main SidebarNav pattern (or at minimum use consistent styling)

**WorkspaceBreadcrumb.tsx:**
- Read the current breadcrumb implementation
- Verify separator character and spacing look right (not too cramped, not too wide)
- Verify text sizes are appropriate for breadcrumb context (should be small, de-emphasized)
- If breadcrumbs use `text-xs`, consider if `text-[11px]` or `text-xs` is more appropriate for the information density
- Verify active (last) breadcrumb item is visually distinguished from clickable ancestors
- Verify breadcrumb doesn't take up too much vertical space (it's contextual, not a heading)

**WorkspaceSidebarPane.tsx fine-tuning:**
- After Plan 02 adds the CreateWorkspaceDialog, verify sidebar workspace list still looks clean
- Verify workspace item hover states are subtle
- Verify folder items have consistent indent and sizing
- Verify the "No folders yet" empty state is not jarring
- Verify the "Archived" collapsible section styling is consistent with the rest

**Dark mode audit:**
- Add the `.dark` class to the html element (or use the theme toggle if one exists)
- Navigate through ALL pages: /, /workspaces, /import, /settings
- Check for: invisible text, missing backgrounds, wrong contrast, broken borders
- Verify pane backgrounds switch to dark card color
- Verify OrgSwitcherBar works in dark mode
- Verify SidebarNav active states (vibe-orange/10 tint) are visible in dark mode
- If dark mode has critical issues (text invisible, layout broken), fix the CSS variables in globals.css
- If dark mode has minor issues (color tweaks needed), fix what's quick but don't spend more than 20% of task time on dark mode per user decision ("desktop must be perfect, mobile just needs to not be broken" — apply similar priority to dark mode)

**General spacing/alignment sweep:**
- Across all pages, verify: headings are consistent (all use `font-montserrat font-extrabold text-xl uppercase tracking-wide`), padding is consistent (p-6 for main content areas), border treatments are consistent (border-border/40 for subtle dividers, border-border/60 for pane borders)
- Fix any one-off spacing inconsistencies found during the audit
  </action>
  <verify>
1. Dev-browser: Navigate to /settings — verify proper empty states (not raw "Coming soon")
2. Dev-browser: Check breadcrumbs on / with a workspace + folder selected — verify spacing and hierarchy
3. Dev-browser: Toggle dark mode — verify no broken layouts or invisible text on /, /workspaces, /import, /settings
4. Dev-browser: Verify SidebarNav orange tint is visible in dark mode
5. Dev-browser: Verify WorkspaceSidebarPane folder items look consistent
6. Run `cd /Users/Naegele/dev/callvault && npx tsc --noEmit`
  </verify>
  <done>
All Phase 16 surfaces pass visual audit. Settings pages have proper empty states. Breadcrumb spacing is appropriate. Dark mode has no critical issues. Spacing and alignment are consistent across all pages. The app meets the "I'd show it to a customer" quality bar.
  </done>
</task>

</tasks>

<verification>
1. Import tab uses vibe-orange underline for active state
2. CallActionMenu is a Radix DropdownMenu with keyboard navigation
3. Settings pages show polished empty states, not raw "Coming soon"
4. Breadcrumb spacing and hierarchy look correct
5. Dark mode has no critical visual issues
6. Spacing and alignment are consistent across all surfaces
7. TypeScript compiles cleanly
</verification>

<success_criteria>
Every Phase 16 surface has been audited and polished. No surface catches the eye negatively. The app feels customer-ready — consistent, tight, and intentional. Import tabs use brand-correct colors. Action menus are accessible. Empty states are proper. Dark mode works.
</success_criteria>

<output>
After completion, create `.planning/phases/16.1-workspace-polish-brand-guidelines/16.1-03-SUMMARY.md`
</output>
