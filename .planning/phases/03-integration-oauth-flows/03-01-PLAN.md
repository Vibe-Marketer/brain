---
phase: 03-integration-oauth-flows
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - supabase/functions/zoom-oauth-callback/index.ts
autonomous: true

must_haves:
  truths:
    - "Zoom OAuth callback uses matching redirect URI as URL generator"
    - "Token exchange request will be accepted by Zoom (no redirect_uri_mismatch)"
  artifacts:
    - path: "supabase/functions/zoom-oauth-callback/index.ts"
      provides: "Zoom OAuth token exchange"
      contains: "https://app.callvaultai.com/oauth/callback/zoom"
  key_links:
    - from: "supabase/functions/zoom-oauth-callback/index.ts"
      to: "supabase/functions/zoom-oauth-url/index.ts"
      via: "identical redirectUri value"
      pattern: "https://app.callvaultai.com/oauth/callback/zoom"
---

<objective>
Fix Zoom OAuth redirect URI mismatch that causes token exchange to fail.

Purpose: The Zoom OAuth callback currently uses a different redirect URI than the URL generator, causing Zoom's token exchange to fail with "redirect_uri_mismatch". This is a one-line fix that unblocks INT-01.

Output: Zoom OAuth callback function with corrected redirect URI matching the URL generator.
</objective>

<execution_context>
@~/.config/Claude/get-shit-done/workflows/execute-plan.md
@~/.config/Claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-integration-oauth-flows/03-RESEARCH.md

# Source files
@supabase/functions/zoom-oauth-callback/index.ts
@supabase/functions/zoom-oauth-url/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix Zoom OAuth callback redirect URI</name>
  <files>supabase/functions/zoom-oauth-callback/index.ts</files>
  <action>
Change line 63 from:
```typescript
const redirectUri = 'https://app.callvaultai.com/oauth/callback/';
```

To:
```typescript
const redirectUri = 'https://app.callvaultai.com/oauth/callback/zoom';
```

This makes the callback redirect URI match the URL generator (zoom-oauth-url/index.ts line 39) exactly. OAuth 2.0 requires character-for-character match between the redirect URI used in authorization URL and token exchange.

WHY: The current URI has a trailing slash and is missing "zoom", causing Zoom's token endpoint to reject the exchange with "redirect_uri_mismatch".
  </action>
  <verify>
1. Read both files and confirm redirect URIs match exactly:
   - `supabase/functions/zoom-oauth-url/index.ts` line 39
   - `supabase/functions/zoom-oauth-callback/index.ts` line 63
2. `grep -r "oauth/callback" supabase/functions/zoom-*` shows identical URIs
  </verify>
  <done>
Both Zoom OAuth functions use `https://app.callvaultai.com/oauth/callback/zoom` as redirect URI.
  </done>
</task>

</tasks>

<verification>
- [ ] `grep "redirectUri = " supabase/functions/zoom-oauth-callback/index.ts` returns line with `/oauth/callback/zoom` (no trailing slash, includes "zoom")
- [ ] `grep "redirectUri = " supabase/functions/zoom-oauth-url/index.ts` returns identical value
- [ ] TypeScript compiles: `npx tsc --noEmit` passes
</verification>

<success_criteria>
- Zoom OAuth callback redirect URI matches URL generator exactly
- No TypeScript errors
- Ready for end-to-end verification in Plan 03-02
</success_criteria>

<output>
After completion, create `.planning/phases/03-integration-oauth-flows/03-01-SUMMARY.md`
</output>
