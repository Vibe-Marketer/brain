---
phase: 10.2-vaults-page
plan: 01
subsystem: ui
tags: [react, tanstack-query, zustand, appshell, routing, vault, supabase]

# Dependency graph
requires:
  - phase: 09-bank-vault-architecture
    provides: Bank/vault tables, useBankContext hook, bank switcher
  - phase: 10-chat-bank-vault-scoping
    provides: Vault-scoped search, multi-tenant isolation
provides:
  - /vaults route with AppShell layout
  - VaultListPane secondary pane component
  - useVaults, useVaultDetail, useVaultRecordings query hooks
  - vault-member panel type in panelStore
  - Sidebar navigation updated to "Vaults"
affects: [10.2-02, 10.2-03, 10.2-04, 10.2-05]

# Tech tracking
tech-stack:
  added: []
  patterns:
    - "VaultListPane follows SortingCategoryPane pattern for secondary pane"
    - "useVaults hook pattern with bank-scoped queries"
    - "URL-driven vault selection with auto-select first vault"

key-files:
  created:
    - src/hooks/useVaults.ts
    - src/pages/VaultsPage.tsx
    - src/components/panes/VaultListPane.tsx
  modified:
    - src/lib/query-config.ts
    - src/types/panel.ts
    - src/stores/panelStore.ts
    - src/components/layout/DetailPaneOutlet.tsx
    - src/App.tsx
    - src/components/ui/sidebar-nav.tsx
    - src/components/Layout.tsx

key-decisions:
  - "Vaults replaces Collaboration in sidebar - RiSafeLine icon used"
  - "/team redirects to /vaults for backward compatibility"
  - "Bank context visible in VaultListPane header (bank type + name)"
  - "Orange left-edge indicator for selected vault (approved vibe-orange use)"

patterns-established:
  - "VaultListPane: bank-scoped vault list with type badges and member counts"
  - "URL-driven vault selection: /vaults/:vaultId with auto-select first"

# Metrics
duration: 2min
completed: 2026-02-09
---

# Phase 10.2 Plan 01: Vaults Page Foundation Summary

**Vaults page with AppShell layout, bank-scoped vault list pane, three query hooks (useVaults/useVaultDetail/useVaultRecordings), and /vaults routing replacing /team**

## Performance

- **Duration:** 2 min
- **Started:** 2026-02-09T23:39:17Z
- **Completed:** 2026-02-09T23:40:54Z
- **Tasks:** 3
- **Files modified:** 10

## Accomplishments
- Created useVaults, useVaultDetail, and useVaultRecordings Tanstack Query hooks with bank-scoped filtering
- Built VaultListPane component with bank name header, vault type badges, member counts, and keyboard navigation
- Created VaultsPage with AppShell layout, URL-driven vault selection, and mobile overlay support
- Wired /vaults route in App.tsx, updated sidebar from "Collaboration" to "Vaults", and added /team redirect

## Task Commits

Each task was committed atomically:

1. **Task 1: Add Query Keys, Panel Types, and useVaults Hook** - `96d8e94` (feat)
2. **Task 2: Create VaultListPane Component** - `f38098a` (feat)
3. **Task 3: Create VaultsPage and Wire Routing** - `e8b4dbc` (feat)

## Files Created/Modified
- `src/hooks/useVaults.ts` - Three query hooks: useVaults, useVaultDetail, useVaultRecordings
- `src/pages/VaultsPage.tsx` - Main vaults page with AppShell, mobile layout, URL-driven selection
- `src/components/panes/VaultListPane.tsx` - Secondary pane with bank header, vault cards, type badges
- `src/lib/query-config.ts` - Added vaults query keys (all, list, detail, members, recordings)
- `src/types/panel.ts` - Added vault-member to PanelType union and PanelData discriminated union
- `src/stores/panelStore.ts` - Re-exports updated PanelType
- `src/components/layout/DetailPaneOutlet.tsx` - Added vault-member case with placeholder
- `src/App.tsx` - Added /vaults and /vaults/:vaultId routes, /team redirect
- `src/components/ui/sidebar-nav.tsx` - Changed Collaboration to Vaults with RiSafeLine/RiSafeFill
- `src/components/Layout.tsx` - Updated getPageLabel for /vaults paths

## Decisions Made
- Replaced "Collaboration" with "Vaults" in sidebar navigation using RiSafeLine icon
- /team redirects to /vaults for backward compatibility (Navigate component with replace)
- Bank context prominently displayed in VaultListPane header (bank type label + bank name)
- Orange left-edge pill indicator for selected vault (approved vibe-orange use #4 - focus states)

## Deviations from Plan

None - plan executed exactly as written. Tasks 1 and 2 were previously committed by an earlier session; Task 3 (routing wiring) was the remaining work.

## Issues Encountered
None

## User Setup Required
None - no external service configuration required.

## Next Phase Readiness
- Foundation complete with working /vaults route and vault list
- Ready for 10.2-02-PLAN.md (Vault Detail View with recordings table)
- VaultListPane's onVaultSelect correctly updates URL for vault detail integration
- vault-member panel type registered and ready for member management UI

## Self-Check: PASSED

---
*Phase: 10.2-vaults-page*
*Completed: 2026-02-09*
