---
phase: 10.3-youtube-specific-vaults-video-intelligence
plan: 05
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/dialogs/CreateVaultDialog.tsx
  - src/components/settings/VaultManagement.tsx
  - src/components/dialogs/__tests__/CreateVaultDialog.test.tsx
  - src/components/settings/__tests__/VaultManagement.test.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Users can select YouTube as a vault type from Hubs create flow"
    - "Users can select YouTube as a hub type from Settings > Vault Management create flow"
    - "Creating a YouTube vault from either surface produces a vault rendered with YouTube type styling"
  artifacts:
    - path: "src/components/dialogs/CreateVaultDialog.tsx"
      provides: "Enabled YouTube option in VAULT_TYPE_OPTIONS"
      contains: "value: 'youtube'"
    - path: "src/components/settings/VaultManagement.tsx"
      provides: "Enabled YouTube SelectItem in create dialog"
      contains: "value=\"youtube\""
    - path: "src/components/dialogs/__tests__/CreateVaultDialog.test.tsx"
      provides: "Regression test asserting YouTube type option is visible and selectable"
      contains: "youtube"
    - path: "src/components/settings/__tests__/VaultManagement.test.tsx"
      provides: "Regression test asserting Settings create flow includes YouTube"
      contains: "youtube"
  key_links:
    - from: "src/components/dialogs/CreateVaultDialog.tsx"
      to: "src/hooks/useVaultMutations.ts"
      via: "selected type is passed as vaultType in create payload"
      pattern: "vaultType.*youtube"
    - from: "src/components/settings/VaultManagement.tsx"
      to: "src/hooks/useVaultMutations.ts"
      via: "selected hub type is sent unchanged to create mutation"
      pattern: "createVault.*youtube"
---

<objective>
Close UAT gap 1 by exposing YouTube as a first-class create option in both vault creation entry points (Hubs dialog and Settings Vault Management), with regression coverage.

Purpose: The backend and rendering paths already support youtube vault_type, but users are blocked by stale hardcoded option lists. This plan restores discoverability and self-serve creation from all user-facing creation surfaces.

Output: Updated create-option lists + automated regression tests for both UI entry points.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10.3-youtube-specific-vaults-video-intelligence/10.3-UAT.md
@.planning/debug/phase-10-3-test-1-youtube-vault-option.md

@src/components/dialogs/CreateVaultDialog.tsx
@src/components/settings/VaultManagement.tsx
@src/types/bank.ts
@src/components/panes/VaultListPane.tsx
@src/hooks/useVaultMutations.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add YouTube create option to both vault creation surfaces</name>
  <files>
    src/components/dialogs/CreateVaultDialog.tsx
    src/components/settings/VaultManagement.tsx
  </files>
  <action>
    Update both stale hardcoded option lists so users can create youtube vaults directly:

    1. In `CreateVaultDialog.tsx`, add an enabled YouTube option in `VAULT_TYPE_OPTIONS` using the same option shape as existing entries.
    2. In `VaultManagement.tsx`, add an enabled `SelectItem` with `value="youtube"` in the Hub Type selector used by the settings create flow.
    3. Preserve current behavior for other types (including intentionally disabled types) and do not change mutation API contracts.
    4. Keep labels consistent with vault list rendering language (`YouTube`) and existing icon/color conventions already defined in `VaultListPane`.
  </action>
  <verify>
    - `npx tsc --noEmit`
    - Manual quick check: both create dialogs render a selectable `YouTube` type option
    - Creating a YouTube vault from each surface succeeds and appears with YouTube badge/icon in vault list
  </verify>
  <done>
    Users can create YouTube vaults from both Hubs and Settings entry points; the option is visible, selectable, and results in a youtube vault_type record.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add regression tests for create-option availability</name>
  <files>
    src/components/dialogs/__tests__/CreateVaultDialog.test.tsx
    src/components/settings/__tests__/VaultManagement.test.tsx
  </files>
  <action>
    Add focused regression tests that fail if YouTube is removed from either creation surface:

    1. Add/extend tests for `CreateVaultDialog` to assert `YouTube` option is rendered and can be selected.
    2. Add/extend tests for `VaultManagement` create selector to assert `youtube` exists and is enabled.
    3. Keep test scope narrow to option exposure and submit payload type value; avoid brittle style assertions.
    4. Follow existing Vitest + Testing Library conventions used in `src/components/**/__tests__`.
  </action>
  <verify>
    - `npx vitest run src/components/dialogs/__tests__/CreateVaultDialog.test.tsx src/components/settings/__tests__/VaultManagement.test.tsx`
    - `npx tsc --noEmit`
  </verify>
  <done>
    Automated tests protect both creation surfaces from regressions that would hide the YouTube vault type again.
  </done>
</task>

</tasks>

<verification>
1. From Hubs create dialog, YouTube appears as a selectable type and create succeeds.
2. From Settings > Vault Management create flow, YouTube appears as a selectable type and create succeeds.
3. Newly created YouTube vaults display with existing YouTube label/icon styling.
4. New component tests pass and fail if youtube option is removed from either surface.
</verification>

<success_criteria>
- UAT gap 1 is closed: users can discover and create YouTube vaults from both reported entry points.
- Regression coverage exists for both UI surfaces, preventing reintroduction of hidden-option mismatch.
</success_criteria>

<output>
After completion, create `.planning/phases/10.3-youtube-specific-vaults-video-intelligence/10.3-05-SUMMARY.md`
</output>
