---
phase: 03.1-compact-integration-ui
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/stores/integrationModalStore.ts
  - src/components/integrations/CompactIntegrationButton.tsx
autonomous: true

must_haves:
  truths:
    - "Integration modal state can be managed from anywhere in the app"
    - "Compact button displays platform icon with connected/disconnected state"
    - "Connected buttons show green ring, checkmark badge, and info icon"
    - "Disconnected buttons show red ring and reduced opacity"
  artifacts:
    - path: "src/stores/integrationModalStore.ts"
      provides: "Global modal state management"
      exports: ["useIntegrationModalStore"]
    - path: "src/components/integrations/CompactIntegrationButton.tsx"
      provides: "56px compact button with state indicators"
      exports: ["CompactIntegrationButton"]
  key_links:
    - from: "src/stores/integrationModalStore.ts"
      to: "zustand"
      via: "create function"
      pattern: "create<IntegrationModalState>"
    - from: "src/components/integrations/CompactIntegrationButton.tsx"
      to: "@radix-ui/react-tooltip"
      via: "TooltipProvider/Trigger/Content"
      pattern: "TooltipProvider.*TooltipTrigger"
---

<objective>
Create the foundational primitives for the compact integration UI: a Zustand store for modal state management and the CompactIntegrationButton component.

Purpose: These primitives enable the modal to be triggered from anywhere (Sync, Settings, Onboarding) and provide the visual representation of integrations as compact 56px buttons.

Output: Two new files - store and button component - that will be composed by subsequent plans.
</objective>

<execution_context>
@~/.config/Claude/get-shit-done/workflows/execute-plan.md
@~/.config/Claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/03.1-compact-integration-ui/03.1-CONTEXT.md
@.planning/phases/03.1-compact-integration-ui/03.1-RESEARCH.md

@src/stores/panelStore.ts
@src/hooks/useIntegrationSync.ts
@src/components/transcript-library/SourcePlatformIcons.tsx
@src/components/ui/tooltip.tsx
@docs/design/brand-guidelines-v4.2.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create integrationModalStore</name>
  <files>src/stores/integrationModalStore.ts</files>
  <action>
Create a Zustand store for managing integration modal state, following the pattern from panelStore.ts.

Store interface:
```typescript
interface IntegrationModalState {
  isOpen: boolean;
  platform: IntegrationPlatform | null;
  openModal: (platform: IntegrationPlatform) => void;
  closeModal: () => void;
}
```

Key implementation details:
- Import `IntegrationPlatform` type from `@/hooks/useIntegrationSync`
- Export `useIntegrationModalStore` hook
- `openModal(platform)` sets `isOpen: true` and `platform`
- `closeModal()` sets `isOpen: false` and `platform: null`
- Keep it simple - no history, no pinning (unlike panelStore)
  </action>
  <verify>
- File exists at src/stores/integrationModalStore.ts
- TypeScript compiles without errors: `npx tsc --noEmit src/stores/integrationModalStore.ts`
- Store exports useIntegrationModalStore
  </verify>
  <done>
integrationModalStore.ts created with openModal/closeModal actions, typed with IntegrationPlatform
  </done>
</task>

<task type="auto">
  <name>Task 2: Create CompactIntegrationButton</name>
  <files>src/components/integrations/CompactIntegrationButton.tsx</files>
  <action>
Create the CompactIntegrationButton component per CONTEXT.md and RESEARCH.md specifications.

Create directory first: `src/components/integrations/`

Component specifications:
- **Size:** 56px x 56px (w-14 h-14)
- **Shape:** Square with rounded corners (rounded-xl)
- **Icon size:** 28px

**Connected state:**
- Full color platform icon (no grayscale)
- Green ring: `ring-2 ring-offset-2 ring-offset-background ring-success`
- Green checkmark badge: Absolute positioned bottom-right (-bottom-1 -right-1), 16px circle, bg-success, white RiCheckLine icon
- Info icon badge: Absolute positioned top-right (-top-1 -right-1), 16px circle, white/card bg, border, RiInformationLine icon

**Disconnected state:**
- Reduced opacity: `opacity-60`
- Grayscale icon: `grayscale` class on Icon
- Red ring: `ring-destructive/50`
- NO badges

**Tooltip (using @radix-ui/react-tooltip):**
- Connected: Show platform name + "Connected", email if available, "Last synced: X ago" if available
- Disconnected: Show platform name + "Click to connect"
- Use formatDistanceToNow from date-fns for relative time

**Props interface:**
```typescript
interface CompactIntegrationButtonProps {
  platform: IntegrationPlatform;
  connected: boolean;
  email?: string;
  lastSyncAt?: string | null;
  onClick: () => void;
}
```

**Imports needed:**
- Tooltip components from @/components/ui/tooltip
- RiCheckLine, RiInformationLine from @remixicon/react
- FathomIcon, GoogleMeetIcon, ZoomIcon from @/components/transcript-library/SourcePlatformIcons
- cn from @/lib/utils
- formatDistanceToNow from date-fns
- IntegrationPlatform from @/hooks/useIntegrationSync

Create platformIcons and platformNames maps inside the component file.

Apply hover effect: `hover:scale-105 hover:shadow-md` with `transition-all duration-200`
  </action>
  <verify>
- File exists at src/components/integrations/CompactIntegrationButton.tsx
- TypeScript compiles: `npx tsc --noEmit src/components/integrations/CompactIntegrationButton.tsx`
- Component exports CompactIntegrationButton
- Uses correct Remix icons (RiCheckLine, RiInformationLine)
- Uses existing platform icons from SourcePlatformIcons
  </verify>
  <done>
CompactIntegrationButton component created with:
- 56px square button with rounded corners
- Green/red ring for connected/disconnected state
- Checkmark and info badges for connected state
- Grayscale and reduced opacity for disconnected
- Tooltip showing connection details
  </done>
</task>

</tasks>

<verification>
After both tasks complete:
1. `npm run build` succeeds with no TypeScript errors
2. Both exports are importable: `import { useIntegrationModalStore } from '@/stores/integrationModalStore'` and `import { CompactIntegrationButton } from '@/components/integrations/CompactIntegrationButton'`
3. No circular dependencies introduced
</verification>

<success_criteria>
1. integrationModalStore.ts exists with useIntegrationModalStore export
2. CompactIntegrationButton.tsx exists with properly typed props
3. Button renders 56px square with ring state indicators
4. Connected state shows green ring + checkmark + info badges
5. Disconnected state shows red ring + opacity + grayscale
6. Tooltip displays appropriate content for each state
7. Build passes with no TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/03.1-compact-integration-ui/03.1-01-SUMMARY.md`
</output>
